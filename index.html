<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Banana</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
</head>
<body>
  <h1 class="title">Banana</h1>
  <div class="chat">
    <input type="text" class="username" placeholder="Username">
    <div class="chat-log"></div>
    <textarea></textarea>
  </div>
  <script src="/socket.io/socket.io.js"></script>
  <script>
  $(function(){
    var socket = io();
    var getNode = function(string){
      return document.querySelector(string);
    },
    messages = getNode('.chat');


    // if(socket !== undefined){
    $('.chat textarea').keypress(function(event){
      var self = this,
        name = $('.username').val();
      var username = getNode('.username').value;
      if(event.which == 13 && !event.shiftKey){
        socket.emit('input', {
          name: name,
          msg: self.value
        });
        event.preventDefault();
        $('.chat textarea').val('');
      }
    });

      socket.on('output', function(data){
        if(data){
          $('.chat-log').append('<span class="message">' + data.name + ': ' +data.msg + '</span>');
        }
      });
    // }
  });

  </script>
</body>
</html>
